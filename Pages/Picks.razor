@page "/picks"

<PageTitle>Picks</PageTitle>

<MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="@((@_scores != null ? "invisible" : ""))" />

@if (_scores is not null)
{
    <h1>Week @_scores?.Week?.Number</h1>
    <MudContainer>
        <MudGrid>
            <MudItem>
                <MudButton Variant="Variant.Filled" Disabled="@(!IsDisabled())">Submit Picks</MudButton>
            </MudItem>
        </MudGrid>
    </MudContainer>
    <MudContainer>
        <MudGrid>
            <MudSpacer />
            @foreach (var score in _scores?.Events?.OrderBy(x => x.Date))
            {
                @foreach (var scoreEvent in score.Competitions.OrderBy(x => x.Competitors[0].Team.Abbreviation))
                {
                    <MudItem xs="4">
                        <MudPaper class="pa-3" Elevation="15">
                            <MudPaper class="pa-2 ma-2" Elevation="5">
                                <MudStack AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Row="true">
                                    <MudImage Src="@scoreEvent.Competitors[0].Team.Logo.ToString()" Width="50" />
                                    <MudPaper Elevation="0">
                                        <MudText Typo="Typo.h6" Class="d-flex justify-end flex-grow-1 gap-4 pr-4">
                                            @GetSpread(@scoreEvent.Competitors[0].Team.Abbreviation)
                                        </MudText>
                                    </MudPaper>
                                    @if (IsSelected(@scoreEvent.Competitors[0].Team.Abbreviation))
                                    {
                                        <MudButton OnClick="@((e) => UnSelectPick(@scoreEvent.Competitors[0].Team.Abbreviation))"
                                            Color="Color.Tertiary" Variant="Variant.Filled">Picked</MudButton>
                                    }
                                    else
                                    {
                                        <MudButton Disabled="@IsDisabled()"
                                            OnClick="@((e) => SelectPick(@scoreEvent.Competitors[0].Team.Abbreviation))"
                                            Color="Color.Warning" Variant="Variant.Filled">Pick</MudButton>
                                    }
                                </MudStack>
                            </MudPaper>
                            <MudDivider></MudDivider>
                            <div>Vs.</div>
                            <MudDivider></MudDivider>
                            <MudPaper class="pa-2 ma-2" Elevation="5">
                                <MudStack AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween" Row="true">
                                    <MudImage Src="@scoreEvent.Competitors[1].Team.Logo.ToString()" Width="50" />
                                    <MudPaper Elevation="0">
                                        <MudText Typo="Typo.h6" Class="d-flex justify-end flex-grow-1 gap-4 pr-4">
                                            @GetSpread(@scoreEvent.Competitors[0].Team.Abbreviation)
                                        </MudText>
                                    </MudPaper>
                                    @if (IsSelected(@scoreEvent.Competitors[1].Team.Abbreviation))
                                    {
                                        <MudButton OnClick="@((e) => UnSelectPick(@scoreEvent.Competitors[1].Team.Abbreviation))"
                                            Color="Color.Tertiary" Variant="Variant.Filled">Picked</MudButton>
                                    }
                                    else
                                    {
                                        <MudButton Disabled="@IsDisabled()"
                                            OnClick="@((e) => SelectPick(@scoreEvent.Competitors[1].Team.Abbreviation))"
                                            Color="Color.Warning" Variant="Variant.Filled">Pick</MudButton>
                                    }

                                </MudStack>
                            </MudPaper>
                        </MudPaper>
                    </MudItem>

                }

            }
        </MudGrid>
    </MudContainer>
}