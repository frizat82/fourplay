@page "/leaderboard"
@using System.Data
@using fourplay.Models
@using fourplay.Models.Enum

<PageTitle>Leaderboard</PageTitle>
<MudContainer>
    <MudGrid Justify="Justify.FlexStart">
        <MudItem xs="12">
            <MudText Align="Align.Center" Typo="Typo.h3">Standings</MudText>
        </MudItem>
        <MudSpacer />
        <MudItem xs="12">
            <MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="@((!@_loading ? "invisible" : ""))" />
        </MudItem>
        <MudItem xs="12">
            @if (_leaderboardModel.Count > 0)
            {
                <MudPaper class="pa-3 full-width" Elevation="3">
                    <MudTable T="LeaderboardModel" Items="_leaderboardModel" Bordered="true" Striped="true" Dense="true"
                        ReadOnly="true" Loading="@_loading" LoadingProgressColor="Color.Info" Breakpoint="Breakpoint.None">
                        <HeaderContent>
                            <MudTh>User</MudTh>
                            <MudTh>
                                <MudTableSortLabel InitialDirection="SortDirection.Descending" SortBy="Sort">Total
                                </MudTableSortLabel>
                            </MudTh>
                            @for (int i = 16; i > 0; i--)
                            {
                                <MudTh>@($"Week {i}")</MudTh>
                            }
                        </HeaderContent>
                        <RowTemplate>
                            @foreach (var userTotal in _leaderboardModel)
                            {
                                <MudTd>@userTotal.User.Email</MudTd>
                                <MudTd>@userTotal.Total</MudTd>
                                @for (int i = 16; i > 0; i--)
                                {
                                    var cellValue = userTotal.WeekResults[i - 1];

                                    @if (cellValue.WeekResult == WeekResult.Won)
                                    {
                                        <MudTd Class="border-solid border-1 mud-border-primary mud-theme-primary" />
                                        <!--<MudIcon Size="Size.Small" Color="Color.Success" Icon="@Icons.Material.Filled.CheckCircle" />-->
                                    }
                                    @if (cellValue.WeekResult == WeekResult.MissingPicks)
                                    {
                                        <MudTd Class="border-solid border-1 mud-border-primary mud-theme-warning" />
                                        <!--<MudIcon Size="Size.Small" Color="Color.Warning" Icon="@Icons.Material.Filled.Warning" />-->
                                    }
                                    else
                                    {
                                        <MudTd Class="border-solid border-1 mud-border-primary mud-theme-error" />
                                        <!--<MudIcon Size="Size.Small" Color="Color.Error" Icon="@Icons.Material.Filled.Cancel" />-->
                                    }

                                }
                            }
                        </RowTemplate>
                    </MudTable>
                </MudPaper>
            }
        </MudItem>
    </MudGrid>
</MudContainer>